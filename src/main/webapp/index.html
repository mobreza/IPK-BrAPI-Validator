<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>BrAVa - Breeding API Validator</title>
  <meta name="description" content="Breeding API Validator">
  <meta name="author" content="IPK Gatersleben">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
  <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="css/selectize.bootstrap4.css">
  <link rel="stylesheet" href="css/styles.css?v=1.0">
</head>
<body>
  <div class="container">
    <div class="row">
      <div class="col">
        <div class="jumbotron py-4">
          <h1 class="text-center display-3">
            <a href="./" class="link-unstyled">BrAVa</a>
          </h1>
          <p class="text-center lead"><a href="http://www.brapi.org">Breeding API</a> (BrAPI) validator</p>
          <p class="text-center">BrAVa is a tool designed to help developers test servers that comply with the <a href="https://brapi.docs.apiary.io/">BrAPI specifications</a> (v1.0).</p>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6 offset-md-3" id="formCol">
        <div class="card bg-light">
          <div class="card-body">
            <form id="testForm">
              <div class="d-flex justify-content-between">
                <h2 class="card-title">Test a BrAPI server</h2>
                <button type="button" id="helpLink" class="btn btn-link">Help</button>
              </div>
              <div class="form-group mb-5">
                <label for="serverurl">
                  Server URL
                </label>
                <select type="url" name="url" id="serverurl" class="form-control font-14" aria-describedby="serverHelp" placeholder="Example: https://test.brapi.org/brapi/v1/" required>
                </select>
                <div class="invalid-feedback">Please provide a valid URL.</div>
                <small id="serverHelp">Enter your own server or test the public servers available in the official BrAPI repository.</small>
              </div>
              <div class="form-check">
                <label class="form-check-label">
                  <input type="radio" name="test" value="structure" class="form-check-input" checked>
                  Structure test: Check structure with <a href="https://github.com/plantbreeding/IPK-BrAPI-Validator/tree/master/src/main/resources/schemas">JSON schemas</a>
                </label>
              </div>
              <div class="form-check mb-5">
                <label class="form-check-label">
                  <input type="radio" name="test" value="data" class="form-check-input">
                  Data integrity: Valid structure and data integrity
                </label>
              </div>
              <div class="form-group" id="resourceDiv">
                <label for="testresource">Resource</label>
                <select name="name" id="testresource" class="form-control">
                  <option class="del" value="#">/calls</option>
                </select>
              </div>
              <div class="form-group" id="dataTestDiv" style="display: none">
                <label for="dataTest">Data test</label>
                <select name="name" id="dataTest" class="form-control">
                  <option value="Complete">Complete (Test everything)</option>
                  <option value="GermplasmData">Germplasm</option>
                  <option value="GermplasmMarkerprofilesData">Germplasm/markerprofile</option>
                  <option value="MarkersData">Markers</option>
                  <option value="TrialsData">Trials</option>
                  <option value="TraitsData">Traits</option>
                  <option value="StudyData">Studies</option>
                  <option value="ObservationVariablesData">Observation Variables</option>
                  <option value="GenomeMapsData">Genome Maps</option>
                  <option value="LocationsData">Locations</option>

                </select>
              </div>
              <div id="paramListDiv" class="form-group">
              </div>
              <hr>
              <div class="form-group" id="testDescriptionDiv" style="display:none">
                <label for="testDescription">Description</label>
                <span id="testDescription" class="font-14"></span>
              </div>
              <div class="form-group">
                <label for="fullurl">Tested URL<span id="multiURL"></span></label>
                <br>
                <div id="fullUrl" class="font-14">
                  <a target="_blank" href="/calls">/calls</a>
                </div>
              </div>
              <div id="statusBar" class="alert alert-danger hidden" role="alert">...</div>
              <div class="d-flex justify-content-between">
                <button type="submit" class="btn btn-primary">Test it now!</button>
                <!-- Button trigger modal -->
                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#exampleModal">
                  Schedule a periodic automated test
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
      <div class="col-md-6 font-14" id="helpCol" style="display:none">
        <div class="card bg-light">
          <div class="card-body">
            <button type="button" class="close" id="closeHelp" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
            <p class="card-text">BrAVa calls one or more resources in the tested server and tests the response. </p>
            <p class="card-text">There are two types of tests available: <strong>structure</strong> tests and <strong>data integrity</strong> tests.</p>
            <p class="card-text"><strong>Structure tests</strong> compare the response to a <a href="http://json-schema.org">JSON schema</a> specific for that resource. It checks the structure, parameter name and parameter types.</p>
            <p class="card-text">For example, the <code>/germplasm-search</code> test requires the response data object to contain a <var>germplasmDbId</var> attribute with a string value, among others.</p>
            <p class="card-text">We created the JSON schemas using the official BrAPI specifications. They are <a href="https://github.com/plantbreeding/IPK-BrAPI-Validator/tree/master/src/main/resources/schemas">available here</a>, feel free to check them and use them in your own tests. They may differ from the official specifications because we update them manually. Let us know of any inconsistencies in the <a href="https://github.com/plantbreeding/IPK-BrAPI-Validator/issues"> issue tracker</a>.</p>

            <p class="card-text"><strong>Data integrity tests</strong> compare the response to a <a href="http://json-schema.org">JSON schema</a> and <strong>also</strong> make sure the data is consistent across resources. This test works by storing a few values from the response. The specific parameters that are saved depend on the test. The server will make a request to other resources using these values as input.</p>
            <p class="card-text">This way you can automatically test some resources that would require manual input for certain parameters.</p>
            <p class="card-text">For example, a call to <code>/markerprofiles</code> could store <var>markerprofileDbId</var>. This value can be used as input for <code>/markerprofiles/{markerprofileDbId}</code>.</p>
          </div>
        </div>
      </div>
    </div>
    <div class="row mt-4">
      <div class="col-md-8 offset-md-2 hidden" id="resultDiv">
      </div>
    </div>
  </div>
  <footer class="footer">
    <div class="container">
      <p class="text-muted">&copy; 2017 | IPK-Gatersleben. This site is licensed under the MIT License. </p>
      <a href="http://www.ipk-gatersleben.de"><img src="http://www.ipk-gatersleben.de/fileadmin/template/main/images-ipk/ipklogo.png" class="footer-logo"></a>
      <a href="https://www.leibniz-gemeinschaft.de/en/home/"><img src="http://www.ipk-gatersleben.de/fileadmin/template/main/images-ipk/sign01.png" class="footer-logo"></a>

    </div>
  </footer>
  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <form id="modalForm">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Set up a periodic report.</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>Register your endpoint here and we'll test it periodically.</p>
            <p>You'll get an email where you can see at a glance how your BrAPI server development is going.</p>
            <div class="form-group">
              <label for="serverUrlModal">
                Server URL
              </label>
              <input type="url" name="url" id="serverUrlModal" class="form-control font-14" placeholder="https://www.brapiserver.com/brapi/v1/" required>
              <div class="invalid-feedback">Please provide a valid URL.</div>
            </div>
            <div class="form-group">
              <label for="emailModal">
                Email
              </label>
              <input type="email" name="email" id="emailModal" class="form-control font-14" aria-describedby="emailHelp" placeholder="dev@brapiserver.com" required>
              <small id="emailHelp">You can stop the test schedule using the unsubscribe link in the test report e-mails</small>
              <div class="invalid-feedback">Please provide a valid email.</div>
            </div>
            <div class="form-check">
              <label class="form-check-label">
                <input type="radio" name="frequency" value="daily" class="form-check-input">
                Daily report
              </label>
            </div>
            <div class="form-check">
              <label class="form-check-label">
                <input type="radio" name="frequency" value="weekly" class="form-check-input" checked>
                Weekly report
              </label>
            </div>
            <div class="form-check">
              <label class="form-check-label">
                <input type="radio" name="frequency" value="monthly" class="form-check-input">
                Monthly report
              </label>
            </div>
            <div class="alert alert-success" role="alert" id="modalSuccess" style="display:none">
              <i class="fa fa-check" aria-hidden="true"></i> Got it! <span class="modalMessage"></span>
            </div>
            <div class="alert alert-danger" role="alert" id="modalFailure" style="display:none">
              <i class="fa fa-frown-o" aria-hidden="true"></i> Oops! There was something wrong. <span id="modalMessage"></span>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary" id="modalSubmit">Submit</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <!-- Github ribbon -->
  <a href="https://github.com/plantbreeding/IPK-BrAPI-Validator"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>
  <!-- /Modal -->
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
  <script src="js/spin.min.js"></script>
  <script src="js/selectize.min.js"></script>
  <script src="js/script.js"></script>
</body>
</html>